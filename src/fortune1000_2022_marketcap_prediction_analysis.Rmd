---
title: "R Analysis of the 2022 Fortune 1000 for Market Cap Prediction"
author: "Stefanus Bernard Melkisedek"
date: "2024-03-07"
output: 
    prettydoc::html_pretty:
        theme: cayman
        highlight: github
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE, fig.path = "../figures/")
```


## Introduction
Fortune, an American Business Magazine, annually publishes the Fortune 500, a ranking of the top 500 firms based on their income. **This dataset comprises the complete Fortune 1000, rather than solely the top 500**.


**The objective of this capstone project is** to analyze the 2022 Fortune 1000 firms in order **to make predictions regarding their market value**. The dataset is sourced from the Kaggle website: [2022 Fortune 1000](https://www.kaggle.com/datasets/winston56/fortune-500-data-2021/data). The **dataset provides updated U.S. firm data for the year 2022**, replacing the previous data from 2021.


## load the libraries
The following libraries will be used in this analysis:

```{r load-packages, message=FALSE, warning=FALSE}
# tidyverse: Collection of packages for data manipulation and visualization
library(tidyverse)

# knitr: Enables dynamic report generation
library(knitr)

# kableExtra: Helps build common complex tables and manipulate table styles
library(kableExtra)

# janitor: Provides simple tools for examining and cleaning dirty data
library(janitor)

# skimr: Provides summary statistics for data exploration
library(skimr)

# broom: Converts statistical analysis objects into tidy format
library(broom)

# car: Companion to Applied Regression, provides tools for regression analysis
library(car)

# MASS: Support functions and datasets for Venables and Ripley's MASS
library(MASS)

# modelr: Provides functions for modelling that help with data tidying
library(modelr)
```

## Business Questions
The following are the business questions that will be addressed in this analysis:

```{r table-business-question, echo=FALSE}
# Define the business questions
business_questions <- data.frame(
  'No.' = c(1, 2, 3),
  'Business_Question' = c(
    'How can we accurately predict the market cap of companies entering the Fortune 1000 list for the first time (Newcomer="yes") based on the available data from the previous year (2022)?',
    'How can we predict the future market cap of companies already present on the 2022 Fortune 1000 list (Newcomer="no") by analyzing the changes in their financial metrics like revenue, profit, and number of employees, along with other factors like rank change, CEO demographics, and sector?',
    'What are the key factors (financial, company-related, or others) that have the most significant influence on the market cap of companies within different sectors present in the Fortune 1000 list?'
  )
)

# Create the table
business_questions %>%
  kable("html") %>%
  kable_styling(bootstrap_options = "striped", full_width = F) %>%
  column_spec(1, bold = TRUE) %>%
  column_spec(2, bold = TRUE) %>%
  row_spec(0, align = "c", bold = TRUE)
```

## Data Wrangling

### Gathering the Data
The dataset is loaded from the CSV file and stored in a dataframe called `fortune_df`.

```{r load-data, echo=TRUE}
# Load the dataset
fortune_df <- read_csv("../data/Fortune_1000.csv")
```







